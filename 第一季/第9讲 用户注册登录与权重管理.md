# 第9讲 用户注册登录与权重管理

tags: bcrypt Express中间件

[TOC]

## 项目

本讲所涉及项目为第4讲创建的项目

[示例项目:CarShopDemoV1](https://github.com/qingfeng365/CarShopDemoV1)

本节内容为05-work分支

## 前端页面引入`holderjs`

`holderjs` 是生成占位图片的工具，用来做测试页面和演示页面非常方便。

在项目根目录命令窗口：

```bash
bower install holderjs
```

修改`server/views/include`目录下的 `foot.jade`

增加一行:

```jade
script(src="/bower_components/holderjs/holder.min.js")
```

## 注册与登录的路由规划


<table>
    <tr>
        <th>
            用途
        </th>
        <th>
            路由
        </th>
        <th>
            模板
        </th>        
    </tr>
    <tr>
        <td>
            注册
        </td>
        <td>
            GET /singup
        </td>
        <td>
            singup.jade
        </td>        
    </tr>
    <tr>
        <td>
            注册 post
        </td>
        <td>
            POST /singup
        </td>
        <td>
        </td>          
    </tr>
    <tr>
        <td>
            登录
        </td>
        <td>
            GET /singin
        </td>
        <td>
            singin.jade
        </td>        
    </tr>
    <tr>
        <td>
            登录 post
        </td>
        <td>
            POST /singin
        </td>
        <td>
        </td>          
    </tr>    
</table>


## 模板增加菜单

修改 `server` 目录下的 `app.js` :

增加一行:

```js
app.locals.appTitle = '汽车商城';
```

修改 `server/views/include` 目录下的 `header.jade`，内容如下：

```jade
.container
	.row.m-a-md
		nav.navbar.navbar-dark.bg-primary
			a.navbar-brand(href="/")
				img(src="holder.js/100x30?theme=sky&text=#{appTitle}")
			ul.nav.   navbar-nav
				li.nav-item.active
					a.nav-link(href='/admin/car/list') 列表
			ul.nav.navbar-nav.pull-right
				li.nav-item
					a.nav-link(href="/singin") 登录
				li.nav-item
					span.nav-link |
				li.nav-item
					a.nav-link(href="/singup") 注册
```






